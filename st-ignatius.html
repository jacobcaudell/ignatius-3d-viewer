<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">
  <title>St. Ignatius - Caudell Spatial Intelligence</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='white'/><text x='50' y='65' font-family='Arial, sans-serif' font-size='50' text-anchor='middle' fill='%23000'>G</text></svg>">
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/CSI_logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/CSI_logo.png">
  <link rel="apple-touch-icon" href="assets/CSI_logo.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/CSI_logo.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8CGY1ENMQX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-8CGY1ENMQX');
  </script>
</head>
<body>
  <header>
    <div class="header-left">
      <img src="assets/CSI_logo.png" alt="CSI Logo" class="logo">
      <div class="header-titles">
        <h1 class="site-title">Caudell Spatial Intelligence</h1>
        <p class="page-title">Uncompromising 3D Reality Capture</p>
      </div>
    </div>
    
    <button class="mobile-nav-toggle" aria-label="Toggle navigation menu">☰</button>
    
    <nav class="main-nav">
      <div class="nav-group">
        <a href="index.html" class="nav-link info">Home</a>
        <a href="about.html" class="nav-link info">About</a>
        <a href="services.html" class="nav-link info">Services</a>
        <a href="contact.html" class="nav-link info">Contact</a>
      </div>
      <div class="nav-divider"></div>
      <div class="nav-group">
        <a href="terrain-modeling.html" class="nav-link portfolio">Pondside Green</a>
        <a href="gasson-hall.html" class="nav-link portfolio">Gasson Hall</a>
        <a href="st-ignatius.html" class="nav-link portfolio active">St. Ignatius</a>
      </div>
    </nav>
  </header>

  <section class="video-gallery">
    <p class="description">
      Interactive 3D visualization transforms static documentation into immersive experiences. This project demonstrates how cutting-edge Gaussian Splatting technology can bring art to life, allowing viewers to explore Pablo Eduardo's 2005 sculpture <em>St. Ignatius of Loyola</em> from any angle in real-time. Experience the intersection of artistic interpretation and technological innovation through dual visual styles that showcase the versatility of modern 3D reconstruction.
    </p>

    <div style="margin:1.25rem 0 2rem">
              <a href="contact.html" class="btn cta">Digitize Your Site →</a>
    </div>

    <hr style="border: none; height: 1px; background: rgba(255,255,255,0.1); margin: 2rem 0;">

    <div class="video-block">
      <p class="tag">Interactive 3D Experience</p>
      <h2><em>St. Ignatius of Loyola</em></h2>
      
      <!-- Desktop: Full Gaussian Splatting viewer -->
      <iframe
        src=""
        data-src="viewer-embedded.html"
        title="St. Ignatius Interactive 3D Viewer"
        id="desktop-viewer"
        style="width: 100%; height: 600px; border: none; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);"
        allow="cross-origin-isolated; fullscreen"
        allowfullscreen
      ></iframe>
      
      <!-- Mobile: Simple message with link -->
      <div id="mobile-message" style="display: none;">
        <div style="text-align: center; padding: 2rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(203, 213, 225, 0.2);">
          <h3 style="color: #ffffff; margin-bottom: 1rem;">Watercolor Model Available</h3>
          <p style="color: #d1d5db; margin-bottom: 1.5rem;">
            The watercolor interpretation of St. Ignatius is available for viewing on mobile devices.
          </p>
          <a 
            href="https://www.useblurry.com/reconstruction/st_ignatius_watercolor-377fq_Ab" 
            target="_blank" 
            rel="noopener"
            style="display: inline-block; background: #60a5fa; color: white; text-decoration: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; transition: background-color 0.2s ease;"
          >
            View Watercolor Model →
          </a>
        </div>
      </div>
      
      <p class="video-caption">
        <strong>Technology</strong>: Real-time Gaussian Splatting with 60fps rendering<br>
        <strong>Artistic Styles</strong>: Photorealistic and watercolor interpretations<br>
        <strong>Interaction</strong>: Mouse orbit, right-click pan, scroll zoom<br>
        <strong>Location</strong>: <em>St. Ignatius of Loyola</em> by Pablo Eduardo (2005), Boston College, Chestnut Hill, Massachusetts
      </p>
      
      <div class="attribution-section">
        <h3>Technical Implementation</h3>
        <p class="attribution-text">
          <strong>Artistic Processing</strong>: <a href="https://amritkwatra.com/experiments/3d-line-drawings" target="_blank" rel="noopener">Amrit Kwatra</a> transformed our drone photography into watercolor-style Gaussian Splats, applying his research on 3D artistic line drawing techniques.<br>
          <strong>Real-time Rendering</strong>: Built with <a href="https://github.com/mkkellogg/GaussianSplats3D" target="_blank" rel="noopener">Mark Kellogg's Three.js-based Gaussian Splats viewer</a> for smooth, interactive 3D exploration.
        </p>
      </div>
    </div>
  </section>

  <div class="cta-section">
    <h2>Does your project demand<br>Spatial Intelligence?</h2>
          <p class="cta-subtitle">Turn your site into an immersive, explorable experience.</p>
          <a href="contact.html" class="cta-button">Digitize Your Site →</a>
  </div>

  <footer>
    <p>&copy; 2025 Caudell Spatial Intelligence</p>
  </footer>

  <script>
    // Simple mobile navigation toggle
    document.addEventListener('DOMContentLoaded', function() {
      const toggle = document.querySelector('.mobile-nav-toggle');
      const nav = document.querySelector('.main-nav');
      
      if (toggle && nav) {
        toggle.onclick = function() {
          nav.classList.toggle('mobile-open');
        };
      }
      
      // Responsive viewer switching
      const desktopViewer = document.getElementById('desktop-viewer');
      const mobileMessage = document.getElementById('mobile-message');
      
      // Error handling for 3D viewer
      function handleViewerError() {
        console.log('3D viewer failed to load, showing fallback');
        desktopViewer.style.display = 'none';
        mobileMessage.style.display = 'block';
        
        // Update message to indicate viewer failure
        const messageContent = mobileMessage.querySelector('div');
        if (messageContent) {
          messageContent.innerHTML = `
            <h3 style="color: #ffffff; margin-bottom: 1rem;">3D Viewer Not Compatible</h3>
            <p style="color: #d1d5db; margin-bottom: 1.5rem;">
              Your browser or device cannot display the interactive 3D viewer. This typically indicates:
              <br>• Outdated graphics drivers
              <br>• Insufficient WebGL support
              <br>• Browser compatibility limitations
            </p>
            <p style="color: #d1d5db; margin-bottom: 1.5rem;">
              <strong>Recommendation:</strong> Update your browser and graphics drivers, or try a different device.
            </p>
            <p style="color: #d1d5db; margin-bottom: 1.5rem;">
              In the meantime, you can view the watercolor interpretation:
            </p>
            <a 
              href="https://www.useblurry.com/reconstruction/st_ignatius_watercolor-377fq_Ab" 
              target="_blank" 
              rel="noopener"
              style="display: inline-block; background: #60a5fa; color: white; text-decoration: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; transition: background-color 0.2s ease;"
            >
              View Watercolor Model →
            </a>
          `;
        }
      }
      
      function switchViewer() {
        console.log('Switching viewer - Screen width:', window.innerWidth);
        if (window.innerWidth <= 768) {
          // Mobile: show message, hide viewer
          console.log('Mobile detected - showing message, hiding viewer');
          desktopViewer.style.display = 'none';
          mobileMessage.style.display = 'block';
        } else {
          // Desktop: show viewer, hide message
          console.log('Desktop detected - showing viewer, hiding message');
          desktopViewer.style.display = 'block';
          mobileMessage.style.display = 'none';
          
          // Only load the iframe source if it hasn't been loaded yet
          if (!desktopViewer.src || desktopViewer.src === window.location.href) {
            console.log('Loading desktop viewer iframe source');
            desktopViewer.src = desktopViewer.dataset.src;
            
            // Add error handling
            desktopViewer.onerror = handleViewerError;
            desktopViewer.onload = function() {
              console.log('3D viewer loaded successfully');
            };
            
            // Set a timeout to detect if viewer takes too long to load
            setTimeout(function() {
              try {
                // Check if iframe has loaded content
                if (desktopViewer.contentDocument && desktopViewer.contentDocument.readyState === 'complete') {
                  console.log('Viewer loaded within timeout');
                  
                  // Check if the viewer actually contains 3D content
                  const has3DContent = desktopViewer.contentDocument.querySelector('canvas') || 
                                       desktopViewer.contentDocument.querySelector('.viewer') ||
                                       desktopViewer.contentDocument.body.innerHTML.includes('3D') ||
                                       desktopViewer.contentDocument.body.innerHTML.includes('viewer');
                  
                  if (!has3DContent) {
                    console.log('Viewer loaded but no 3D content detected, showing fallback');
                    handleViewerError();
                  }
                } else {
                  console.log('Viewer loading timeout, checking for errors');
                  // Check if there are any error indicators in the iframe
                  try {
                    if (desktopViewer.contentWindow.location.href.includes('error') || 
                        desktopViewer.contentDocument.title.includes('Error')) {
                      handleViewerError();
                    }
                  } catch (e) {
                    // Cross-origin restrictions, but we can still detect basic loading issues
                    console.log('Cross-origin restriction, but viewer appears to be loading');
                  }
                }
              } catch (e) {
                // If we can't access the iframe content due to cross-origin restrictions,
                // we'll assume it's working and let the user experience determine success
                console.log('Cross-origin restriction, viewer appears to be loading');
              }
            }, 10000); // 10 second timeout
          }
        }
      }
      
      // Set initial state based on current screen size
      console.log('Initial load - Screen width:', window.innerWidth);
      if (window.innerWidth <= 768) {
        // Mobile: start with message visible, viewer hidden
        console.log('Initial mobile state - showing message, hiding viewer');
        desktopViewer.style.display = 'none';
        mobileMessage.style.display = 'block';
        // Don't load the iframe source on mobile
      } else {
        // Desktop: start with viewer visible, message hidden
        console.log('Initial desktop state - showing viewer, hiding message');
        desktopViewer.style.display = 'block';
        mobileMessage.style.display = 'none';
        // Load the iframe source for desktop
        console.log('Loading desktop viewer iframe source on initial load');
        desktopViewer.src = desktopViewer.dataset.src;
      }
      
      // Switch on window resize
      window.addEventListener('resize', switchViewer);
    });
  </script>
</body>
</html>
